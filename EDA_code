# This R code can be used to perform detailed exploratory data analysis
# on a dataset.

library(tidyverse)
library(reshape2)
library(corrplot)

# Load the data
data <- read.csv("data.csv")

# Print the first five rows of the data
cat("First five rows of the data:\n")
head(data)

# Get the shape of the data
cat("Shape of the data:\n")
dim(data)

# Check for missing values
cat("Number of missing values:\n")
colSums(is.na(data))

# Drop missing values
data <- na.omit(data)

# Get the data types of the columns
cat("Data types of the columns:\n")
sapply(data, class)

# Get the summary statistics of the numerical columns
cat("Summary statistics of the numerical columns:\n")
summary(data %>% select_if(is.numeric))

# Get the unique values and their frequencies for categorical columns
cat("Unique values and their frequencies for categorical columns:\n")
for (column in names(data)[sapply(data, is.character)]) {
  cat(column, ":\n")
  table(data[,column])
  cat("\n")
}

# Plot histograms of the numerical columns
cat("Histograms of the numerical columns:\n")
data %>% select_if(is.numeric) %>% 
  gather() %>% 
  ggplot(aes(x=value)) +
  geom_histogram(bins=20, fill="lightblue", color="white") +
  facet_wrap(~key, scales="free") +
  theme_classic() +
  labs(x="Value", y="Count")

# Plot box plots of the numerical columns
cat("Box plots of the numerical columns:\n")
data %>% select_if(is.numeric) %>% 
  gather() %>% 
  ggplot(aes(x=key, y=value)) +
  geom_boxplot(fill="lightblue", color="white") +
  facet_wrap(~key, scales="free") +
  theme_classic() +
  labs(x="", y="Value")

# Plot correlation matrix of the numerical columns
cat("Correlation matrix of the numerical columns:\n")
corr_matrix <- cor(data %>% select_if(is.numeric))
corrplot(corr_matrix, method="color", type="upper", tl.col="black", addCoef.col="black", diag=FALSE)

# Plot scatter plots of the numerical columns against the target variable
cat("Scatter plots of the numerical columns against the target variable:\n")
target_column <- "target"
numerical_columns <- names(data)[sapply(data, is.numeric) & names(data) != target_column]
data %>% select(c(numerical_columns, target_column)) %>% 
  gather(-target) %>% 
  ggplot(aes_string(x=target_column, y="value", color="key")) +
  geom_point() +
  facet_wrap(~key, scales="free") +
  theme_classic() +
  labs(x=target_column, y="Value")
